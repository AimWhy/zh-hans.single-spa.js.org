(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{183:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"rightToc",(function(){return r})),n.d(t,"default",(function(){return p}));var a=n(1),i=n(9),o=(n(0),n(300)),c={id:"migrating-existing-spas",title:"\u8fc1\u79fb\u73b0\u6709\u7684 SPA \u5e94\u7528",sidebar_label:"\u8fc1\u79fb\u73b0\u6709\u7684\u4ee3\u7801"},r=[{value:"\u5c06 SPA \u5e94\u7528\u8f6c\u6362\u4e3a\u6ce8\u518c\u5e94\u7528",id:"\u5c06-spa-\u5e94\u7528\u8f6c\u6362\u4e3a\u6ce8\u518c\u5e94\u7528",children:[{value:"(1) \u5b9e\u73b0\u751f\u547d\u5468\u671f",id:"1-\u5b9e\u73b0\u751f\u547d\u5468\u671f",children:[]},{value:"(2) \u4f7f CSS\u3001\u5b57\u4f53\u548c <code>&lt;script&gt;</code> \u7b49\u4f9d\u8d56\u751f\u6548",id:"2-\u4f7f-css\u3001\u5b57\u4f53\u548c-script-\u7b49\u4f9d\u8d56\u751f\u6548",children:[]}]},{value:"Converting SPAs into registered applications",id:"converting-spas-into-registered-applications",children:[{value:"(1) Implementing lifecycle functions",id:"1-implementing-lifecycle-functions",children:[]},{value:"(2) Getting the CSS, fonts, <code>&lt;script&gt;</code> dependencies to work",id:"2-getting-the-css-fonts-script-dependencies-to-work",children:[]}]}],l={rightToc:r},s="wrapper";function p(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(o.b)(s,Object(a.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"<<<<<<< HEAD\n\u5982\u679c\u4f60\u60f3\u5c06\u73b0\u6709\u7684 SPA \u5e94\u7528\u8fc1\u79fb\u5230 single-spa \u6846\u67b6\u4e2d\uff0c\u9700\u8981\u505a\u4e09\u4ef6\u4e8b\uff1a"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"\u521b\u5efa\u4e00\u4e2a",Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"configuration"}),"single spa \u914d\u7f6e")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"#converting-spas-into-registered-applications"}),"\u5c06 SPA \u5e94\u7528\u8f6c\u6362\u4e3a\u6ce8\u518c\u5e94\u7528")),Object(o.b)("li",{parentName:"ol"},"\u8c03\u6574 html \u6587\u4ef6\uff0c\u4f7f single-spa \u914d\u7f6e\u751f\u6548\uff0c\u67e5\u770b",Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"configuration#indexhtml-file"}),"\u6587\u6863"))),Object(o.b)("h2",{id:"\u5c06-spa-\u5e94\u7528\u8f6c\u6362\u4e3a\u6ce8\u518c\u5e94\u7528"},"\u5c06 SPA \u5e94\u7528\u8f6c\u6362\u4e3a\u6ce8\u518c\u5e94\u7528"),Object(o.b)("p",null,"\u4f60\u73b0\u6709\u7684 SPA \u5e94\u7528\uff0c\u65e0\u8bba\u662f\u57fa\u4e8e Angular\uff0cReact \u8fd8\u662f\u5176\u4ed6\u6280\u672f\uff0c\u53ef\u80fd\u90fd\u65e0\u6cd5\u4ece DOM \u4e2d\u5c06\u81ea\u8eab\u5378\u8f7d\u3002\u800c\u4e14\uff0c\u53ef\u80fd\u90fd\u662f\u63a7\u5236\u6574\u4e2a html \u9875\u9762\uff0c\u800c\u4e0d\u662f\u4e00\u4e2a\u4e0d\u5bf9",Object(o.b)("inlineCode",{parentName:"p"},"<script>"),"\u6807\u7b7e\u548c",Object(o.b)("inlineCode",{parentName:"p"},"<link>"),"\u6807\u7b7e\u8fdb\u884c\u552f\u4e00\u63a7\u5236\u7684\u5355\u7eaf JavaScript \u5e94\u7528\u7a0b\u5e8f\u3002\u56e0\u6b64\uff0c\u4e3a\u4e86\u5c06\u5b83\u4eec\u8f6c\u6362\u4e3a single-spa \u6ce8\u518c\u5e94\u7528\uff0c\u9700\u8981\u5728\u5b9e\u73b0\u5176\u751f\u547d\u5468\u671f\u529f\u80fd\u65f6\u5904\u7406\u6389\u8fd9\u4e9b\u95ee\u9898\u3002"),Object(o.b)("h3",{id:"1-\u5b9e\u73b0\u751f\u547d\u5468\u671f"},"(1) \u5b9e\u73b0\u751f\u547d\u5468\u671f"),Object(o.b)("p",null,"\u8bf7\u53c2\u9605",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/building-applications#registered-application-lifecycle"}),"\u6ce8\u518c\u5e94\u7528\u7684\u751f\u547d\u5468\u671f\u6587\u6863"),"\uff0c\u4ee5\u4e86\u89e3\u9700\u8981\u505a\u4ec0\u4e48\u3002\u6700\u96be\u7684\u90e8\u5206\u53ef\u80fd\u5c31\u662f ",Object(o.b)("inlineCode",{parentName:"p"},"unmount")," \u8fd9\u4e2a\u751f\u547d\u5468\u671f\uff0c\u56e0\u4e3a\u5927\u591a\u6570 SPA \u90fd\u4e0d\u4f1a\u4f11\u7720\u5e76\u4ece DOM \u5378\u8f7d\u81ea\u8eab\u3002\u5728\u5b9e\u73b0\u751f\u547d\u5468\u671f\u529f\u80fd\u65f6\uff0c\u8bf7\u5148\u67e5\u770b",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/ecosystem"}),"\u751f\u6001\u7cfb\u7edf\u6587\u6863"),"\u3002\u5982\u679c\u6587\u6863\u4e2d\u6ca1\u6709\u5217\u51fa\u4f60\u6240\u4f7f\u7528\u7684\u6280\u672f\u6808\uff0c\u5219\u5fc5\u987b\u786e\u4fdd\u5728\u4f60\u81ea\u5df1\u5b9e\u73b0\u7684 ",Object(o.b)("inlineCode",{parentName:"p"},"unmount")," \u4e2d\uff0c\u80fd\u591f\u6e05\u7406\u5176 DOM \u8282\u70b9\uff0cDOM \u4e8b\u4ef6\u4fa6\u542c\uff08\u6240\u6709\u7684\u4e8b\u4ef6\u4fa6\u542c\uff0c\u5c24\u5176\u662f ",Object(o.b)("inlineCode",{parentName:"p"},"hashchange")," \u548c ",Object(o.b)("inlineCode",{parentName:"p"},"popstate"),"\uff09\u4ee5\u53ca\u91ca\u653e\u5185\u5b58\u3002"),Object(o.b)("h3",{id:"2-\u4f7f-css\u3001\u5b57\u4f53\u548c-script-\u7b49\u4f9d\u8d56\u751f\u6548"},"(2) \u4f7f CSS\u3001\u5b57\u4f53\u548c ",Object(o.b)("inlineCode",{parentName:"h3"},"<script>")," \u7b49\u4f9d\u8d56\u751f\u6548"),Object(o.b)("h1",{id:"\u7531\u4e8e\u73b0\u6709\u7684-spa-\u5e94\u7528\u4e2d\uff0c-css\u3001\u5b57\u4f53\u3001\u7b2c\u4e09\u65b9\u811a\u672c\u7b49\u4f9d\u8d56\u90fd\u5728-indexhtml-\u6587\u4ef6\u4e2d\uff0c\u56e0\u6b64\u4f60\u53ef\u80fd\u5fc5\u987b\u505a\u4e00\u4e9b\u5de5\u4f5c\uff0c\u4ee5\u786e\u4fdd\u5f53\u4f60\u7684-spa-\u5e94\u7528\u53d8\u6210\u4e86\u65e0-html-\u5e94\u7528\u7a0b\u5e8f\u4e4b\u540e\uff0c\u8fd9\u4e9b\u4f9d\u8d56\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u3002\u6700\u597d\u662f\u5c06\u6240\u6709\u7684\u8d44\u6e90\u90fd\u6253\u5305\u5230-js-\u6587\u4ef6\u4e2d\uff0c\u4f46\u662f\u4f60\u4e5f\u53ef\u4ee5\u5c06\u6240\u9700\u8981\u7684\u8d44\u6e90\u5217\u5728single-spa-\u914d\u7f6e\u4e2d\u3002"},"\u7531\u4e8e\u73b0\u6709\u7684 SPA \u5e94\u7528\u4e2d\uff0c CSS\u3001\u5b57\u4f53\u3001\u7b2c\u4e09\u65b9\u811a\u672c\u7b49\u4f9d\u8d56\u90fd\u5728 index.html \u6587\u4ef6\u4e2d\uff0c\u56e0\u6b64\u4f60\u53ef\u80fd\u5fc5\u987b\u505a\u4e00\u4e9b\u5de5\u4f5c\uff0c\u4ee5\u786e\u4fdd\u5f53\u4f60\u7684 SPA \u5e94\u7528\u53d8\u6210\u4e86",Object(o.b)("a",Object(a.a)({parentName:"h1"},{href:"/docs/building-applications"}),"\u65e0 HTML \u5e94\u7528\u7a0b\u5e8f"),"\u4e4b\u540e\uff0c\u8fd9\u4e9b\u4f9d\u8d56\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u3002\u6700\u597d\u662f\u5c06\u6240\u6709\u7684\u8d44\u6e90\u90fd\u6253\u5305\u5230 js \u6587\u4ef6\u4e2d\uff0c\u4f46\u662f\u4f60\u4e5f\u53ef\u4ee5\u5c06\u6240\u9700\u8981\u7684\u8d44\u6e90\u5217\u5728",Object(o.b)("a",Object(a.a)({parentName:"h1"},{href:"configuration"}),"single spa \u914d\u7f6e"),"\u4e2d\u3002"),Object(o.b)("p",null,"If you're interested in migrating existing SPAs into a single-spa, you'll\nneed to do three things:"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Create a ",Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"./configuration"}),"single spa config")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"#converting-spas-into-registered-applications"}),"Convert your SPA or SPAs to be registered applications")),Object(o.b)("li",{parentName:"ol"},"Adjust your html file so that your single spa config is the new boss in town.\nSee ",Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"configuration#indexhtml-file"}),"docs"),".")),Object(o.b)("h2",{id:"converting-spas-into-registered-applications"},"Converting SPAs into registered applications"),Object(o.b)("p",null,"Your existing SPAs, whether they be Angular, React, or something else, probably are\nnot used to unmounting themselves from the DOM. Also, they probably have had the luxury\nof controlling the entire html page themselves, instead of being purely javascript applications\nthat don't have sole control over ",Object(o.b)("inlineCode",{parentName:"p"},"<script>")," tags and ",Object(o.b)("inlineCode",{parentName:"p"},"<link>")," tags. So in order to convert them\ninto single-spa registered applications, they will need to overcome those obstacles while implementing\nlifecycle functions."),Object(o.b)("h3",{id:"1-implementing-lifecycle-functions"},"(1) Implementing lifecycle functions"),Object(o.b)("p",null,"See the ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/building-applications#registered-application-lifecycle"}),"registered application lifecycle")," docs to see what you need to do.\nThe hardest part will almost certainly be the ",Object(o.b)("inlineCode",{parentName:"p"},"unmount")," lifecycle, since most SPAs aren't accustomed\nto going dormant and unmounting themselves from the DOM. When implementing your lifecycle functions, first check out the ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/ecosystem"}),"ecosystem"),"\ndocs before reinventing the wheel yourself. If that doesn't have everything you need, you'll have to make sure that your\nSPA can clean up its DOM, DOM event listeners (all of them, but ",Object(o.b)("em",{parentName:"p"},"especially")," hashchange and popstate),\nand memory."),Object(o.b)("h3",{id:"2-getting-the-css-fonts-script-dependencies-to-work"},"(2) Getting the CSS, fonts, ",Object(o.b)("inlineCode",{parentName:"h3"},"<script>")," dependencies to work"),Object(o.b)("p",null,"Since existing SPAs are used to having an index.html file for their css, fonts,\nthird party script-tags, etc., it's likely that you'll have to do some work\nto make sure all of those keep on working when your SPA becomes an html-less ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/building-applications"}),"\napplication"),". It is best to try to put all that\nyou can into the javascript bundle, but your escape hatch is to put the things\nyou need into your ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"configuration"}),"single spa config"),"."),Object(o.b)("blockquote",null,Object(o.b)("blockquote",{parentName:"blockquote"},Object(o.b)("blockquote",{parentName:"blockquote"},Object(o.b)("blockquote",{parentName:"blockquote"},Object(o.b)("blockquote",{parentName:"blockquote"},Object(o.b)("blockquote",{parentName:"blockquote"},Object(o.b)("blockquote",{parentName:"blockquote"},Object(o.b)("p",{parentName:"blockquote"},"1de816a740e96c0b4cc1f641548666d628e1d5ed")))))))))}p.isMDXComponent=!0},300:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return b}));var a=n(0),i=n.n(a),o=i.a.createContext({}),c=function(e){var t=i.a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):Object.assign({},t,e)),n},r=function(e){var t=c(e.components);return i.a.createElement(o.Provider,{value:t},e.children)};var l="mdxType",s={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},p=Object(a.forwardRef)((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,r=e.parentName,l=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&-1===t.indexOf(a)&&(n[a]=e[a]);return n}(e,["components","mdxType","originalType","parentName"]),p=c(n),b=a,u=p[r+"."+b]||p[b]||s[b]||o;return n?i.a.createElement(u,Object.assign({},{ref:t},l,{components:n})):i.a.createElement(u,Object.assign({},{ref:t},l))}));function b(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,c=new Array(o);c[0]=p;var r={};for(var s in t)hasOwnProperty.call(t,s)&&(r[s]=t[s]);r.originalType=e,r[l]="string"==typeof e?e:a,c[1]=r;for(var b=2;b<o;b++)c[b]=n[b];return i.a.createElement.apply(null,c)}return i.a.createElement.apply(null,n)}p.displayName="MDXCreateElement"}}]);